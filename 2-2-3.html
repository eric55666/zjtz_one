<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>股票交易实战 - 模拟炒股与市场分析</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c, #2a3c7f, #3d52a0);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }
        
        h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
            text-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
            background: linear-gradient(90deg, #ff9e00, #ffd166);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        
        .subtitle {
            font-size: 1.2rem;
            color: #a8c0ff;
            margin-bottom: 20px;
        }
        
        .game-area {
            display: grid;
            grid-template-columns: 1fr;
            gap: 25px;
        }
        
        .panel {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .panel-title {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: #ffd166;
            display: flex;
            align-items: center;
            gap: 10px;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.2);
        }
        
        .step {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .step.active {
            display: block;
        }
        
        .stock-chart {
            width: 100%;
            height: 300px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            margin: 20px 0;
            position: relative;
            overflow: hidden;
        }
        
        .chart-container {
            padding: 15px;
            height: 100%;
        }
        
        .chart-line {
            stroke: #4cc9f0;
            stroke-width: 2;
            fill: none;
        }
        
        .chart-grid {
            stroke: rgba(255, 255, 255, 0.1);
            stroke-width: 1;
        }
        
        .chart-labels {
            font-size: 12px;
            fill: rgba(255, 255, 255, 0.7);
        }
        
        .trading-area {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }
        
        @media (max-width: 768px) {
            .trading-area {
                grid-template-columns: 1fr;
            }
        }
        
        .stock-info {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 12px;
            padding: 15px;
        }
        
        .stock-name {
            font-size: 1.4rem;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .stock-price {
            font-size: 2rem;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .price-up {
            color: #06d6a0;
        }
        
        .price-down {
            color: #ef476f;
        }
        
        .stock-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 15px;
        }
        
        .detail-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .trade-form {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 12px;
            padding: 20px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 15px;
        }
        
        label {
            font-weight: bold;
            color: #ffd166;
        }
        
        input, select {
            padding: 12px;
            border: none;
            border-radius: 8px;
            background: rgba(0, 0, 0, 0.3);
            color: white;
            font-size: 1rem;
        }
        
        /* 特别为下拉列表设置样式 */
        select option {
            background: rgba(0, 0, 0, 0.8);
            color: white;
        }
        
        input::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }
        
        .trade-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 20px;
        }
        
        button {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            background: linear-gradient(45deg, #4361ee, #3a0ca3);
            color: white;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        button:disabled {
            background: rgba(255, 255, 255, 0.2);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .btn-buy {
            background: linear-gradient(45deg, #06d6a0, #04a777);
        }
        
        .btn-sell {
            background: linear-gradient(45deg, #ef476f, #d00000);
        }
        
        .btn-secondary {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        
        .portfolio {
            margin-top: 30px;
        }
        
        .portfolio-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        
        .portfolio-table th, .portfolio-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .portfolio-table th {
            color: #ffd166;
            font-weight: bold;
        }
        
        .bubble-cards {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .bubble-card {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s;
        }
        
        .bubble-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }
        
        .bubble-title {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 10px;
            color: #ffd166;
        }
        
        .bubble-period {
            font-size: 0.9rem;
            color: #a8c0ff;
            margin-bottom: 15px;
        }
        
        .bubble-description {
            line-height: 1.6;
            margin-bottom: 15px;
        }
        
        .bubble-lessons {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
        }
        
        .lessons-title {
            font-weight: bold;
            margin-bottom: 10px;
            color: #ffd166;
        }
        
        .reflection-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-top: 20px;
        }
        
        textarea {
            padding: 15px;
            border: none;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.15);
            color: white;
            font-size: 1rem;
            min-height: 120px;
            resize: vertical;
        }
        
        textarea::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }
        
        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }
        
        .results-section {
            display: none;
            margin-top: 30px;
        }
        
        .results-section.active {
            display: block;
        }
        
        .score-display {
            text-align: center;
            margin: 20px 0;
            font-size: 1.5rem;
            font-weight: bold;
        }
        
        .learning-advice {
            margin-top: 30px;
        }
        
        .advice-list {
            list-style-type: none;
            padding-left: 0;
            margin-top: 15px;
        }
        
        .advice-item {
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: flex-start;
            gap: 10px;
        }
        
        .advice-item:last-child {
            border-bottom: none;
        }
        
        .advice-icon {
            color: #4cc9f0;
            font-size: 1.2rem;
        }
        
        .step-indicator {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
        }
        
        .step-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
        }
        
        .step-dot.active {
            background: #4cc9f0;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .completion-badge {
            display: inline-block;
            background: linear-gradient(45deg, #ff9e00, #ffd166);
            color: #1a2a6c;
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: bold;
            margin-top: 15px;
        }
        
        .feedback {
            margin-top: 15px;
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 0.9rem;
        }
        
        .feedback.correct {
            background: rgba(6, 214, 160, 0.2);
            border-left: 4px solid #06d6a0;
        }
        
        .feedback.incorrect {
            background: rgba(239, 71, 111, 0.2);
            border-left: 4px solid #ef476f;
        }
        
        .cash-balance {
            font-size: 1.2rem;
            font-weight: bold;
            margin: 15px 0;
            text-align: center;
            background: rgba(255, 255, 255, 0.1);
            padding: 10px;
            border-radius: 8px;
        }
        
        .transaction-history {
            margin-top: 20px;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .transaction-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.9rem;
        }
        
        .transaction-buy {
            color: #06d6a0;
        }
        
        .transaction-sell {
            color: #ef476f;
        }
        
        .stocks-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .stock-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }
        
        .stock-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .stock-card.selected {
            border-color: #4cc9f0;
            background: rgba(76, 201, 240, 0.1);
        }
        
        .stock-symbol {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .stock-company {
            font-size: 0.9rem;
            color: #a8c0ff;
            margin-bottom: 10px;
        }
        
        .stock-card-price {
            font-size: 1.3rem;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-chart-line"></i> 股票交易实战</h1>
            <div class="subtitle">参与模拟炒股，分析股票价格指数，学习历史资产泡沫事件</div>
            <div class="step-indicator">
                <div class="step-dot active" data-step="1"></div>
                <div class="step-dot" data-step="2"></div>
                <div class="step-dot" data-step="3"></div>
                <div class="step-dot" data-step="4"></div>
                <div class="step-dot" data-step="5"></div>
            </div>
        </header>
        
        <div class="game-area">
            <!-- 步骤1：股票基础知识与指数介绍 -->
            <div class="panel step active" id="step1">
                <div class="panel-title">
                    <i class="fas fa-info-circle"></i> 第一步：股票基础知识与指数介绍
                </div>
                
                <p>在开始交易前，让我们先了解股票市场的基本知识和主要股票价格指数。</p>
                
                <div class="stock-chart">
                    <div class="chart-container" id="index-chart">
                        <!-- 图表将通过JavaScript生成 -->
                    </div>
                </div>
                
                <div class="bubble-cards">
                    <div class="bubble-card">
                        <div class="bubble-title">上证指数</div>
                        <div class="bubble-description">
                            上海证券交易所综合股价指数，简称上证指数，是反映上海证券交易所挂牌股票总体走势的统计指标。
                        </div>
                    </div>
                    
                    <div class="bubble-card">
                        <div class="bubble-title">深证成指</div>
                        <div class="bubble-description">
                            深圳证券交易所成份股价指数，简称深证成指，是深圳证券交易所的主要股指。
                        </div>
                    </div>
                    
                    <div class="bubble-card">
                        <div class="bubble-title">沪深300指数</div>
                        <div class="bubble-description">
                            由沪深证券交易所联合发布的反映A股市场整体走势的指数，选取300只规模大、流动性好的股票作为样本。
                        </div>
                    </div>
                    
                    <div class="bubble-card">
                        <div class="bubble-title">道琼斯指数</div>
                        <div class="bubble-description">
                            道琼斯工业平均指数，简称道指，是美国股票市场的重要指标，包含30家大型上市公司。
                        </div>
                    </div>
                </div>
                
                <div class="navigation">
                    <div></div> <!-- 占位 -->
                    <button class="btn" id="next-to-bubbles">
                        下一步：历史泡沫事件 <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </div>
            
            <!-- 步骤2：历史资产泡沫案例分析 -->
            <div class="panel step" id="step2">
                <div class="panel-title">
                    <i class="fas fa-history"></i> 第二步：历史资产泡沫案例分析
                </div>
                
                <p>了解历史上的资产泡沫事件，可以帮助我们识别市场风险，做出更明智的投资决策。</p>
                
                <div class="bubble-cards">
                    <div class="bubble-card">
                        <div class="bubble-title">郁金香狂热</div>
                        <div class="bubble-period">1634-1637年，荷兰</div>
                        <div class="bubble-description">
                            郁金香狂热是历史上最早的资产泡沫事件之一。在荷兰黄金时代，郁金香球茎的价格被炒作到极高的水平，一个稀有品种的价格甚至相当于当时一栋豪宅的价格。
                        </div>
                        <div class="bubble-lessons">
                            <div class="lessons-title">经验教训：</div>
                            <ul>
                                <li>资产价格可能严重偏离其内在价值</li>
                                <li>集体投机行为可能引发市场崩溃</li>
                                <li>稀有性不等于投资价值</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="bubble-card">
                        <div class="bubble-title">互联网泡沫</div>
                        <div class="bubble-period">1995-2000年，全球</div>
                        <div class="bubble-description">
                            互联网泡沫是指1995年至2000年间与互联网及信息技术相关的公司股价快速上涨，随后在2000年急剧下跌的事件。纳斯达克指数在此期间上涨了400%，然后在两年内下跌了78%。
                        </div>
                        <div class="bubble-lessons">
                            <div class="lessons-title">经验教训：</div>
                            <ul>
                                <li>新技术不一定能立即转化为利润</li>
                                <li>高估值需要实际业绩支撑</li>
                                <li>市场情绪可以推动价格远离基本面</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="bubble-card">
                        <div class="bubble-title">2008年金融危机</div>
                        <div class="bubble-period">2007-2008年，全球</div>
                        <div class="bubble-description">
                            由美国次级抵押贷款市场崩溃引发的全球金融危机。房地产市场的过度投机和金融衍生品的滥用导致全球金融市场动荡，多家大型金融机构倒闭或被救助。
                        </div>
                        <div class="bubble-lessons">
                            <div class="lessons-title">经验教训：</div>
                            <ul>
                                <li>过度杠杆化会增加系统性风险</li>
                                <li>金融创新需要适当监管</li>
                                <li>资产价格泡沫可能波及整个经济</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div class="navigation">
                    <button class="btn btn-secondary" id="back-to-basics">
                        <i class="fas fa-arrow-left"></i> 上一步
                    </button>
                    <button class="btn" id="next-to-trading">
                        下一步：模拟交易 <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </div>
            
            <!-- 步骤3：模拟炒股交易 -->
            <div class="panel step" id="step3">
                <div class="panel-title">
                    <i class="fas fa-coins"></i> 第三步：模拟炒股交易
                </div>
                
                <div class="cash-balance">
                    初始资金: <span id="cash-amount">¥100,000</span>
                </div>
                
                <div class="stocks-grid" id="stocks-grid">
                    <!-- 股票卡片将通过JavaScript动态生成 -->
                </div>
                
                <div class="trading-area">
                    <div class="stock-info">
                        <div class="stock-name" id="selected-stock-name">请选择股票</div>
                        <div class="stock-price" id="current-price">--</div>
                        <div class="stock-change" id="price-change">--</div>
                        
                        <div class="stock-details" id="stock-details">
                            <!-- 股票详情将通过JavaScript动态生成 -->
                        </div>
                        
                        <div class="stock-chart">
                            <div class="chart-container" id="stock-chart">
                                <!-- 股票图表将通过JavaScript生成 -->
                            </div>
                        </div>
                    </div>
                    
                    <div class="trade-form">
                        <div class="form-group">
                            <label for="stock-select">选择股票</label>
                            <select id="stock-select">
                                <option value="">请选择股票</option>
                                <!-- 股票选项将通过JavaScript动态生成 -->
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="trade-type">交易类型</label>
                            <select id="trade-type">
                                <option value="buy">买入</option>
                                <option value="sell">卖出</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="shares">股数</label>
                            <input type="number" id="shares" min="1" max="1000" value="10">
                        </div>
                        
                        <div class="form-group">
                            <label for="limit-price">限价 (¥)</label>
                            <input type="number" id="limit-price" step="0.01" value="0.00">
                        </div>
                        
                        <div class="trade-buttons">
                            <button class="btn btn-buy" id="place-buy-order">
                                <i class="fas fa-shopping-cart"></i> 买入
                            </button>
                            <button class="btn btn-sell" id="place-sell-order">
                                <i class="fas fa-money-bill-wave"></i> 卖出
                            </button>
                        </div>
                        
                        <div class="portfolio">
                            <div class="panel-title">
                                <i class="fas fa-wallet"></i> 投资组合
                            </div>
                            <table class="portfolio-table">
                                <thead>
                                    <tr>
                                        <th>股票</th>
                                        <th>持股</th>
                                        <th>成本价</th>
                                        <th>当前价</th>
                                        <th>盈亏</th>
                                    </tr>
                                </thead>
                                <tbody id="portfolio-body">
                                    <!-- 投资组合内容将通过JavaScript动态生成 -->
                                </tbody>
                            </table>
                        </div>
                        
                        <div class="transaction-history">
                            <div class="panel-title">
                                <i class="fas fa-list"></i> 交易记录
                            </div>
                            <div id="transaction-list">
                                <!-- 交易记录将通过JavaScript动态生成 -->
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="navigation">
                    <button class="btn btn-secondary" id="back-to-bubbles">
                        <i class="fas fa-arrow-left"></i> 上一步
                    </button>
                    <button class="btn" id="next-to-reflection">
                        下一步：反思总结 <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </div>
            
            <!-- 步骤4：反思总结 -->
            <div class="panel step" id="step4">
                <div class="panel-title">
                    <i class="fas fa-clipboard-check"></i> 第四步：反思总结
                </div>
                
                <div class="results-section active">
                    <div class="score-display">
                        您的投资表现
                    </div>
                    
                    <div class="portfolio">
                        <table class="portfolio-table">
                            <thead>
                                <tr>
                                    <th>指标</th>
                                    <th>数值</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>初始资金</td>
                                    <td>¥100,000</td>
                                </tr>
                                <tr>
                                    <td>最终资产</td>
                                    <td id="final-assets">¥0</td>
                                </tr>
                                <tr>
                                    <td>总收益</td>
                                    <td id="total-return">¥0</td>
                                </tr>
                                <tr>
                                    <td>收益率</td>
                                    <td id="return-rate">0%</td>
                                </tr>
                                <tr>
                                    <td>交易次数</td>
                                    <td id="trade-count">0</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="reflection-form">
                        <div class="form-group">
                            <label for="strategy-reflection">您的交易策略是什么？哪些决策是成功的，哪些是失败的？</label>
                            <textarea id="strategy-reflection" placeholder="请描述您的交易策略和决策过程..."></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label for="emotion-reflection">在交易过程中，您如何管理自己的情绪？情绪对您的决策有何影响？</label>
                            <textarea id="emotion-reflection" placeholder="请描述您在交易过程中的情绪变化..."></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label for="lessons-reflection">从这次模拟交易中，您学到了哪些关于股票投资的重要经验？</label>
                            <textarea id="lessons-reflection" placeholder="请总结您从这次模拟交易中学到的经验..."></textarea>
                        </div>
                    </div>
                </div>
                
                <div class="navigation">
                    <button class="btn btn-secondary" id="back-to-trading">
                        <i class="fas fa-arrow-left"></i> 上一步
                    </button>
                    <button class="btn" id="next-to-summary">
                        下一步：学习要点总结 <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </div>
            
            <!-- 步骤5：学习要点总结 -->
            <div class="panel step" id="step5">
                <div class="panel-title">
                    <i class="fas fa-graduation-cap"></i> 第五步：学习要点总结
                </div>
                
                <div class="results-section active">
                    <div class="learning-advice">
                        <div class="completion-badge">恭喜完成股票交易实战模拟！</div>
                        
                        <div class="panel-title" style="margin-top: 25px;">
                            <i class="fas fa-graduation-cap"></i> 学习要点总结
                        </div>
                        
                        <ul class="advice-list">
                            <li class="advice-item">
                                <i class="fas fa-check-circle advice-icon"></i>
                                <span>股票价格指数是反映市场整体走势的重要指标</span>
                            </li>
                            <li class="advice-item">
                                <i class="fas fa-check-circle advice-icon"></i>
                                <span>历史资产泡沫事件提醒我们市场可能存在非理性繁荣</span>
                            </li>
                            <li class="advice-item">
                                <i class="fas fa-check-circle advice-icon"></i>
                                <span>成功的投资需要结合基本面分析和技术分析</span>
                            </li>
                            <li class="advice-item">
                                <i class="fas fa-check-circle advice-icon"></i>
                                <span>情绪管理是投资成功的关键因素之一</span>
                            </li>
                            <li class="advice-item">
                                <i class="fas fa-check-circle advice-icon"></i>
                                <span>分散投资和风险管理是长期投资成功的基础</span>
                            </li>
                        </ul>
                        
                        <div class="panel-title" style="margin-top: 25px;">
                            <i class="fas fa-book"></i> 推荐学习资源
                        </div>
                        
                        <ul class="advice-list">
                            <li class="advice-item">
                                <i class="fas fa-book-open advice-icon"></i>
                                <span>《聪明的投资者》- 本杰明·格雷厄姆</span>
                            </li>
                            <li class="advice-item">
                                <i class="fas fa-book-open advice-icon"></i>
                                <span>《股票作手回忆录》- 埃德温·勒菲弗</span>
                            </li>
                            <li class="advice-item">
                                <i class="fas fa-book-open advice-icon"></i>
                                <span>《漫步华尔街》- 伯顿·马尔基尔</span>
                            </li>
                            <li class="advice-item">
                                <i class="fas fa-book-open advice-icon"></i>
                                <span>上海证券交易所投资者教育网站（https://edu.sse.com.cn/attention/）</span>
                            </li>
                        </ul>
                    </div>
                </div>
                
                <div class="navigation">
                    <button class="btn btn-secondary" id="back-to-reflection">
                        <i class="fas fa-arrow-left"></i> 上一步
                    </button>
                    <button class="btn" id="restart-game">
                        <i class="fas fa-redo"></i> 重新开始
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 游戏状态管理
            const steps = document.querySelectorAll('.step');
            const stepDots = document.querySelectorAll('.step-dot');
            let currentStep = 1;
            
            // 模拟交易相关变量
            let cashBalance = 100000;
            let portfolio = {};
            let transactionHistory = [];
            let tradeCount = 0;
            let selectedStock = null;
            
            // 股票数据
            const stocks = {
                'TECHP': {
                    name: '科技先锋',
                    price: 125.60,
                    history: [120, 122, 121, 123, 124, 125, 126, 125.6],
                    open: 122.50,
                    high: 126.80,
                    low: 121.90,
                    volume: '2.5M',
                    pe: 28.5,
                    dividend: 1.2
                },
                'FINT': {
                    name: '金融科技',
                    price: 85.30,
                    history: [82, 83, 84, 85, 86, 85.5, 85, 85.3],
                    open: 84.20,
                    high: 86.50,
                    low: 82.80,
                    volume: '1.8M',
                    pe: 22.3,
                    dividend: 1.8
                },
                'HEAL': {
                    name: '健康医疗',
                    price: 210.75,
                    history: [205, 208, 209, 210, 211, 212, 211.5, 210.75],
                    open: 209.50,
                    high: 213.20,
                    low: 204.80,
                    volume: '1.2M',
                    pe: 35.7,
                    dividend: 0.9
                },
                'ENER': {
                    name: '新能源',
                    price: 45.20,
                    history: [42, 43, 44, 45, 46, 45.5, 45, 45.2],
                    open: 44.80,
                    high: 46.50,
                    low: 42.50,
                    volume: '3.2M',
                    pe: 18.9,
                    dividend: 2.5
                }
            };
            
            // 初始化图表
            function initCharts() {
                // 初始化指数图表
                const indexChart = document.getElementById('index-chart');
                const indexSvg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
                indexSvg.setAttribute("width", "100%");
                indexSvg.setAttribute("height", "100%");
                indexChart.appendChild(indexSvg);
                
                // 模拟指数数据
                const indexData = [3200, 3250, 3300, 3350, 3400, 3450, 3500, 3550, 3600, 3650];
                drawChart(indexSvg, indexData, "指数走势");
            }
            
            // 绘制图表函数
            function drawChart(svg, data, title) {
                const width = svg.clientWidth;
                const height = svg.clientHeight;
                const padding = 40;
                
                // 清除之前的内容
                svg.innerHTML = '';
                
                // 计算比例尺
                const xScale = (width - 2 * padding) / (data.length - 1);
                const yMin = Math.min(...data);
                const yMax = Math.max(...data);
                const yRange = yMax - yMin || 1; // 防止除零
                const yScale = (height - 2 * padding) / yRange;
                
                // 绘制网格线
                for (let i = 0; i <= 5; i++) {
                    const y = padding + (height - 2 * padding) * i / 5;
                    const gridLine = document.createElementNS("http://www.w3.org/2000/svg", "line");
                    gridLine.setAttribute("x1", padding);
                    gridLine.setAttribute("y1", y);
                    gridLine.setAttribute("x2", width - padding);
                    gridLine.setAttribute("y2", y);
                    gridLine.setAttribute("class", "chart-grid");
                    svg.appendChild(gridLine);
                    
                    // Y轴标签
                    const labelValue = yMax - (yRange * i / 5);
                    const label = document.createElementNS("http://www.w3.org/2000/svg", "text");
                    label.setAttribute("x", padding - 10);
                    label.setAttribute("y", y + 4);
                    label.setAttribute("text-anchor", "end");
                    label.setAttribute("class", "chart-labels");
                    label.textContent = labelValue.toFixed(0);
                    svg.appendChild(label);
                }
                
                // 绘制X轴标签
                for (let i = 0; i < data.length; i += Math.ceil(data.length / 5)) {
                    const x = padding + i * xScale;
                    const label = document.createElementNS("http://www.w3.org/2000/svg", "text");
                    label.setAttribute("x", x);
                    label.setAttribute("y", height - padding + 20);
                    label.setAttribute("text-anchor", "middle");
                    label.setAttribute("class", "chart-labels");
                    label.textContent = `第${i+1}天`;
                    svg.appendChild(label);
                }
                
                // 绘制折线
                const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
                let pathData = `M ${padding} ${height - padding - (data[0] - yMin) * yScale}`;
                
                for (let i = 1; i < data.length; i++) {
                    const x = padding + i * xScale;
                    const y = height - padding - (data[i] - yMin) * yScale;
                    pathData += ` L ${x} ${y}`;
                }
                
                path.setAttribute("d", pathData);
                path.setAttribute("class", "chart-line");
                svg.appendChild(path);
                
                // 添加标题
                const titleElem = document.createElementNS("http://www.w3.org/2000/svg", "text");
                titleElem.setAttribute("x", width / 2);
                titleElem.setAttribute("y", padding - 10);
                titleElem.setAttribute("text-anchor", "middle");
                titleElem.setAttribute("class", "chart-labels");
                titleElem.setAttribute("font-weight", "bold");
                titleElem.textContent = title;
                svg.appendChild(titleElem);
            }
            
            // 初始化股票卡片
            function initStockCards() {
                const stocksGrid = document.getElementById('stocks-grid');
                stocksGrid.innerHTML = '';
                
                for (const symbol in stocks) {
                    const stock = stocks[symbol];
                    const card = document.createElement('div');
                    card.className = 'stock-card';
                    card.setAttribute('data-symbol', symbol);
                    
                    const change = stock.history[stock.history.length - 1] - stock.history[stock.history.length - 2];
                    const changePercent = (change / stock.history[stock.history.length - 2] * 100).toFixed(2);
                    
                    card.innerHTML = `
                        <div class="stock-symbol">${symbol}</div>
                        <div class="stock-company">${stock.name}</div>
                        <div class="stock-card-price">¥${stock.price.toFixed(2)}</div>
                        <div class="${change >= 0 ? 'price-up' : 'price-down'}">${change >= 0 ? '+' : ''}${changePercent}%</div>
                    `;
                    
                    card.addEventListener('click', function() {
                        selectStock(symbol);
                    });
                    
                    stocksGrid.appendChild(card);
                }
                
                // 初始化股票选择下拉列表
                const stockSelect = document.getElementById('stock-select');
                stockSelect.innerHTML = '<option value="">请选择股票</option>';
                
                for (const symbol in stocks) {
                    const option = document.createElement('option');
                    option.value = symbol;
                    option.textContent = `${symbol} - ${stocks[symbol].name}`;
                    stockSelect.appendChild(option);
                }
                
                stockSelect.addEventListener('change', function() {
                    if (this.value) {
                        selectStock(this.value);
                    }
                });
            }
            
            // 选择股票
            function selectStock(symbol) {
                selectedStock = symbol;
                
                // 更新股票卡片选中状态
                document.querySelectorAll('.stock-card').forEach(card => {
                    card.classList.remove('selected');
                });
                document.querySelector(`.stock-card[data-symbol="${symbol}"]`).classList.add('selected');
                
                // 更新股票选择下拉列表
                document.getElementById('stock-select').value = symbol;
                
                // 更新股票信息显示
                updateStockInfo(symbol);
            }
            
            // 更新股票信息
            function updateStockInfo(symbol) {
                const stock = stocks[symbol];
                
                // 更新股票名称
                document.getElementById('selected-stock-name').textContent = `${stock.name} (${symbol})`;
                
                // 更新股票价格
                document.getElementById('current-price').textContent = `¥${stock.price.toFixed(2)}`;
                
                // 更新价格变化
                const prevPrice = stock.history[stock.history.length - 2];
                const change = stock.price - prevPrice;
                const changePercent = (change / prevPrice * 100).toFixed(2);
                
                const changeElem = document.getElementById('price-change');
                changeElem.textContent = `${change >= 0 ? '+' : ''}${changePercent}%`;
                changeElem.className = change >= 0 ? 'price-up' : 'price-down';
                
                // 更新股票详情
                const stockDetails = document.getElementById('stock-details');
                stockDetails.innerHTML = `
                    <div class="detail-item">
                        <span>开盘价:</span>
                        <span>¥${stock.open.toFixed(2)}</span>
                    </div>
                    <div class="detail-item">
                        <span>最高价:</span>
                        <span>¥${stock.high.toFixed(2)}</span>
                    </div>
                    <div class="detail-item">
                        <span>最低价:</span>
                        <span>¥${stock.low.toFixed(2)}</span>
                    </div>
                    <div class="detail-item">
                        <span>成交量:</span>
                        <span>${stock.volume}</span>
                    </div>
                    <div class="detail-item">
                        <span>市盈率:</span>
                        <span>${stock.pe}</span>
                    </div>
                    <div class="detail-item">
                        <span>股息率:</span>
                        <span>${stock.dividend}%</span>
                    </div>
                `;
                
                // 更新限价输入框
                document.getElementById('limit-price').value = stock.price.toFixed(2);
                
                // 更新股票图表
                const stockSvg = document.querySelector('#stock-chart svg');
                if (stockSvg) {
                    drawChart(stockSvg, stock.history, `${symbol} 价格走势`);
                } else {
                    const stockChart = document.getElementById('stock-chart');
                    const newSvg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
                    newSvg.setAttribute("width", "100%");
                    newSvg.setAttribute("height", "100%");
                    stockChart.innerHTML = '';
                    stockChart.appendChild(newSvg);
                    drawChart(newSvg, stock.history, `${symbol} 价格走势`);
                }
            }
            
            // 更新股票价格
            function updateStockPrices() {
                for (const symbol in stocks) {
                    const stock = stocks[symbol];
                    
                    // 模拟价格波动
                    const changePercent = (Math.random() - 0.5) * 0.1; // -5% 到 +5%
                    stock.price = stock.price * (1 + changePercent);
                    stock.price = Math.round(stock.price * 100) / 100; // 保留两位小数
                    
                    // 更新价格历史
                    stock.history.push(stock.price);
                    if (stock.history.length > 20) {
                        stock.history.shift();
                    }
                    
                    // 更新股票卡片显示
                    const card = document.querySelector(`.stock-card[data-symbol="${symbol}"]`);
                    if (card) {
                        const change = stock.history[stock.history.length - 1] - stock.history[stock.history.length - 2];
                        const changePercent = (change / stock.history[stock.history.length - 2] * 100).toFixed(2);
                        
                        card.querySelector('.stock-card-price').textContent = `¥${stock.price.toFixed(2)}`;
                        const changeElem = card.querySelector('.price-up, .price-down');
                        changeElem.textContent = `${change >= 0 ? '+' : ''}${changePercent}%`;
                        changeElem.className = change >= 0 ? 'price-up' : 'price-down';
                    }
                }
                
                // 如果当前有选中的股票，更新其信息
                if (selectedStock) {
                    updateStockInfo(selectedStock);
                }
                
                // 更新投资组合显示
                updatePortfolioDisplay();
            }
            
            // 更新投资组合显示
            function updatePortfolioDisplay() {
                const portfolioBody = document.getElementById('portfolio-body');
                portfolioBody.innerHTML = '';
                
                let totalValue = cashBalance;
                
                for (const symbol in portfolio) {
                    const holding = portfolio[symbol];
                    const currentValue = holding.shares * stocks[symbol].price;
                    const costValue = holding.shares * holding.avgPrice;
                    const profit = currentValue - costValue;
                    const profitPercent = (profit / costValue * 100).toFixed(2);
                    
                    totalValue += currentValue;
                    
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${symbol} - ${stocks[symbol].name}</td>
                        <td>${holding.shares}</td>
                        <td>¥${holding.avgPrice.toFixed(2)}</td>
                        <td>¥${stocks[symbol].price.toFixed(2)}</td>
                        <td class="${profit >= 0 ? 'price-up' : 'price-down'}">${profit >= 0 ? '+' : ''}¥${profit.toFixed(2)} (${profitPercent}%)</td>
                    `;
                    portfolioBody.appendChild(row);
                }
                
                // 如果没有持股，显示空状态
                if (Object.keys(portfolio).length === 0) {
                    const row = document.createElement('tr');
                    row.innerHTML = `<td colspan="5" style="text-align: center;">暂无持股</td>`;
                    portfolioBody.appendChild(row);
                }
                
                // 更新现金余额显示
                document.getElementById('cash-amount').textContent = `¥${cashBalance.toFixed(2)}`;
                
                // 更新最终资产显示（在步骤4）
                document.getElementById('final-assets').textContent = `¥${totalValue.toFixed(2)}`;
                document.getElementById('total-return').textContent = `¥${(totalValue - 100000).toFixed(2)}`;
                document.getElementById('return-rate').textContent = `${((totalValue - 100000) / 100000 * 100).toFixed(2)}%`;
                document.getElementById('trade-count').textContent = tradeCount;
            }
            
            // 更新交易记录
            function updateTransactionHistory() {
                const transactionList = document.getElementById('transaction-list');
                transactionList.innerHTML = '';
                
                // 显示最近10笔交易
                const recentTransactions = transactionHistory.slice(-10).reverse();
                
                if (recentTransactions.length === 0) {
                    const emptyMsg = document.createElement('div');
                    emptyMsg.className = 'transaction-item';
                    emptyMsg.textContent = '暂无交易记录';
                    transactionList.appendChild(emptyMsg);
                    return;
                }
                
                recentTransactions.forEach(transaction => {
                    const item = document.createElement('div');
                    item.className = `transaction-item ${transaction.type === 'buy' ? 'transaction-buy' : 'transaction-sell'}`;
                    
                    const timeStr = new Date(transaction.timestamp).toLocaleTimeString();
                    item.innerHTML = `
                        <span>${timeStr}</span>
                        <span>${transaction.type === 'buy' ? '买入' : '卖出'} ${transaction.shares}股 ${transaction.stock}</span>
                        <span>¥${transaction.price.toFixed(2)}</span>
                    `;
                    
                    transactionList.appendChild(item);
                });
            }
            
            // 执行买入订单
            function executeBuyOrder(symbol, shares, price) {
                const totalCost = shares * price;
                
                if (totalCost > cashBalance) {
                    alert('资金不足，无法完成买入交易！');
                    return false;
                }
                
                // 更新现金余额
                cashBalance -= totalCost;
                
                // 更新投资组合
                if (!portfolio[symbol]) {
                    portfolio[symbol] = {
                        shares: 0,
                        avgPrice: 0,
                        totalCost: 0
                    };
                }
                
                const holding = portfolio[symbol];
                const newTotalCost = holding.totalCost + totalCost;
                const newShares = holding.shares + shares;
                
                holding.shares = newShares;
                holding.avgPrice = newTotalCost / newShares;
                holding.totalCost = newTotalCost;
                
                // 记录交易
                transactionHistory.push({
                    type: 'buy',
                    stock: symbol,
                    shares: shares,
                    price: price,
                    timestamp: new Date()
                });
                
                tradeCount++;
                
                // 更新显示
                updatePortfolioDisplay();
                updateTransactionHistory();
                
                return true;
            }
            
            // 执行卖出订单
            function executeSellOrder(symbol, shares, price) {
                if (!portfolio[symbol] || portfolio[symbol].shares < shares) {
                    alert('持股不足，无法完成卖出交易！');
                    return false;
                }
                
                const totalValue = shares * price;
                
                // 更新现金余额
                cashBalance += totalValue;
                
                // 更新投资组合
                const holding = portfolio[symbol];
                holding.shares -= shares;
                
                // 如果全部卖出，从投资组合中移除
                if (holding.shares === 0) {
                    delete portfolio[symbol];
                }
                
                // 记录交易
                transactionHistory.push({
                    type: 'sell',
                    stock: symbol,
                    shares: shares,
                    price: price,
                    timestamp: new Date()
                });
                
                tradeCount++;
                
                // 更新显示
                updatePortfolioDisplay();
                updateTransactionHistory();
                
                return true;
            }
            
            // 初始化交易事件监听
            function initTradingEvents() {
                document.getElementById('place-buy-order').addEventListener('click', function() {
                    if (!selectedStock) {
                        alert('请先选择股票！');
                        return;
                    }
                    
                    const shares = parseInt(document.getElementById('shares').value);
                    const price = parseFloat(document.getElementById('limit-price').value);
                    
                    if (shares <= 0) {
                        alert('请输入有效的股数！');
                        return;
                    }
                    
                    if (price <= 0) {
                        alert('请输入有效的价格！');
                        return;
                    }
                    
                    if (executeBuyOrder(selectedStock, shares, price)) {
                        alert(`成功买入 ${shares} 股 ${selectedStock}，价格 ¥${price.toFixed(2)}`);
                    }
                });
                
                document.getElementById('place-sell-order').addEventListener('click', function() {
                    if (!selectedStock) {
                        alert('请先选择股票！');
                        return;
                    }
                    
                    const shares = parseInt(document.getElementById('shares').value);
                    const price = parseFloat(document.getElementById('limit-price').value);
                    
                    if (shares <= 0) {
                        alert('请输入有效的股数！');
                        return;
                    }
                    
                    if (price <= 0) {
                        alert('请输入有效的价格！');
                        return;
                    }
                    
                    if (executeSellOrder(selectedStock, shares, price)) {
                        alert(`成功卖出 ${shares} 股 ${selectedStock}，价格 ¥${price.toFixed(2)}`);
                    }
                });
                
                // 定期更新股票价格
                setInterval(updateStockPrices, 5000);
            }
            
            // 步骤导航
            document.getElementById('next-to-bubbles').addEventListener('click', function() {
                navigateToStep(2);
            });
            
            document.getElementById('back-to-basics').addEventListener('click', function() {
                navigateToStep(1);
            });
            
            document.getElementById('next-to-trading').addEventListener('click', function() {
                navigateToStep(3);
            });
            
            document.getElementById('back-to-bubbles').addEventListener('click', function() {
                navigateToStep(2);
            });
            
            document.getElementById('next-to-reflection').addEventListener('click', function() {
                navigateToStep(4);
                updatePortfolioDisplay(); // 确保最终资产数据是最新的
            });
            
            document.getElementById('back-to-trading').addEventListener('click', function() {
                navigateToStep(3);
            });
            
            document.getElementById('next-to-summary').addEventListener('click', function() {
                navigateToStep(5);
            });
            
            document.getElementById('back-to-reflection').addEventListener('click', function() {
                navigateToStep(4);
            });
            
            document.getElementById('restart-game').addEventListener('click', function() {
                // 重置所有状态
                cashBalance = 100000;
                portfolio = {};
                transactionHistory = [];
                tradeCount = 0;
                selectedStock = null;
                
                // 重置股票价格
                for (const symbol in stocks) {
                    stocks[symbol].price = stocks[symbol].history[stocks[symbol].history.length - 1];
                }
                
                // 重置表单
                document.getElementById('strategy-reflection').value = '';
                document.getElementById('emotion-reflection').value = '';
                document.getElementById('lessons-reflection').value = '';
                
                // 更新显示
                initStockCards();
                updatePortfolioDisplay();
                updateTransactionHistory();
                
                // 回到第一步
                navigateToStep(1);
            });
            
            // 导航到指定步骤
            function navigateToStep(stepNumber) {
                currentStep = stepNumber;
                
                // 更新步骤显示
                steps.forEach(step => step.classList.remove('active'));
                document.getElementById(`step${stepNumber}`).classList.add('active');
                
                // 更新步骤指示器
                stepDots.forEach(dot => dot.classList.remove('active'));
                document.querySelector(`.step-dot[data-step="${stepNumber}"]`).classList.add('active');
            }
            
            // 初始化
            initCharts();
            initStockCards();
            initTradingEvents();
            updatePortfolioDisplay();
            updateTransactionHistory();
        });
    </script>
</body>
</html>